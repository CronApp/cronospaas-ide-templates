<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE urlrewrite PUBLIC "-//tuckey.org//DTD UrlRewrite 4.0//EN"
        "http://www.tuckey.org/res/dtds/urlrewrite4.0.dtd">
<!--

    Configuration file for UrlRewriteFilter
    http://www.tuckey.org/urlrewrite/

-->
<urlrewrite>
<!-- 
	 <rule>
        <name>Bloquear XXX</name>

	    <condition type="session-attribute"
	    name="ROLE_NAME"
	    operator="notequal"
	    next="and">admin</condition>
	    <condition type="method">GET|POST|PUT|DELETE</condition>
        <from>^/protected.jsp$</from>
        <set type="status">403</set>
        <to>null</to>
        
    </rule>

	 <rule>
        <name>Force Login</name>

	    <condition type="session-attribute"
	    name="ROLE_NAME"
	    operator="equal"
	    next="and">^$</condition>
	    <condition type="method">GET|POST|PUT|DELETE</condition>
        <from>^(?!.*?login.jsp).*</from>
        <set type="status">403</set>
        <to>login.jsp</to>
        
    </rule>

    -->

	 <rule>
        <name>Force Login</name>

	    <condition type="session-attribute"
	    name="IS_ADMIN"
	    operator="equal"
	    next="and">false</condition>
	    <condition type="method">GET|POST|PUT|DELETE</condition>
        <from>.</from>
        <set type="status">403</set>
        <to>null</to>
        
    </rule>



	<!-- 
     <rule>
         <from>/User</from>
         <to type="redirect">%{context-path}/protected.jsp</to>
     </rule>
     -->
     
     <!-- 
     <rule>
        <name>Disable Directory</name>
		<condition type="method" next="or">DELETE</condition>
        <condition type="method">GET</condition>
        <from>/User</from>
        <set type="status">403</set>
        <to>null</to>
    </rule>
    -->

</urlrewrite>

